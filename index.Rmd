---
title: "Gov 50 Final Project"
author: "Ayla Aliyeva"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---
```{r}
library(tidyverse)
```

Variable Name        Variable Description
-------------        --------------------
country              Country                                                                                                                                                                                                     
sftgname             English country name                                                                                                                                                                                    
constchg70           Major Constitutional Changes: The number of basic alternations in a state's constitution (1970s)                                                                                                                     
constchg80           Major Constitutional Changes: The number of basic alternations in a state's constitution (1980s)                                                                                                                       
corrupti             Knack and Keefer measure of corruption (1980-89)






##Code

## Reading and merging data, calculating average number of consitutional changes and average years in power


```{r}
violence <- read_csv("data(final project gov 50)/Violence/violence.csv")

dpi <- read_csv("data(final project gov 50)/DPI2020/DPI2020.csv")

violence <- 
  violence |>
  mutate(constch_overall = constchg70 + constchg80) 

dpi <- 
  dpi |>
  filter(year >= 1970 & year <= 1989) 
  
 colnames(dpi) [1] <- "country"

  dpi <- 
   dpi |>
  group_by(country) |>
  mutate(avg_yrsoffc = mean(yrsoffc, na.rm = TRUE)) |>
  filter(yrsoffc >= 0)
  
  
dpi <- 
  dpi|>
  mutate(country = toupper(country))

 data <- 
   merge(violence, dpi, by = "country") 
 
 data <- data |>
   select(country,year, constchg70, constchg80, constch_overall, corrupti, yrsoffc, avg_yrsoffc)
 


```


                                                    
                                                                                            
## Visualisation 1 - Corruption vs. Number of Constitutional Changes

```{r}
data |>
ggplot(mapping = aes(x = corrupti, y = constch_overall)) + geom_point() + labs (title = "Number of Constitutional Changes by Corruption Level", y = "Number of Constitutional Changes", x = "Corruption Level") 

```






## Visualisation 2 - Avg Number of Constitutional Changes vs. AVGYRSOFFC

```{r}
data |>
  group_by(country) |>
  summarise(avg_yrsoffc = mean(avg_yrsoffc, na.rm = TRUE),
            constch_overall = mean(constch_overall, na.rm = TRUE)) |>
  ggplot(mapping = aes(y = avg_yrsoffc, x = constch_overall)) + geom_col() + labs(y = "Mean Chief Officer Term", x = "Number of Constitutional Changes") 
```




## Visualisation 3 - Results, Regression, Combining everything 
 

```{r}

data <- 
  data |>
  mutate(avgyrs_range = case_when(
    avg_yrsoffc <= 5 ~ "5 Years and Under",
    avg_yrsoffc > 5 & avg_yrsoffc <= 15 ~ "Between 5 and 15 Years",
    avg_yrsoffc > 15 & avg_yrsoffc <= 25 ~ "Between 15 and 25 Years",
    avg_yrsoffc >= 25 ~ "Over 25 Years"
  ))


fit <- lm(constch_overall ~ corrupti, data = data)

fit

fit_visual <- data |> ggplot(mapping = aes(x = corrupti, y = constch_overall, colour = avgyrs_range)) + geom_point() + geom_smooth(method = lm, colour = "brown") + labs(title = "Linear Regression on Corruption and Constitutional Changes", y = "Number of Constitutional Changes", x = "Corruption Level", colour = "Mean Chief Executive Term" , caption = "Corruption Level of 0 being most corrupt, and a Level of 6 being least corrupt")

fit_visual
```




























