---
title: "Gov 50 Final Project"
author: "Ayla Aliyeva"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---
```{r}
library(tidyverse)
```

Variable Name        Variable Description
-------------        --------------------
country              Country                                                                                                                                                                                                     
sftgname             English country name                                                                                                                                                                                    
constchg70           Major Constitutional Changes: The number of basic alternations in a state's constitution (1970s)                                                                                                                     
constchg80           Major Constitutional Changes: The number of basic alternations in a state's constitution (1980s)                                                                                                                       
corrupti             Knack and Keefer measure of corruption (1980-89)






##Code

## Reading and merging data, calculating average number of consitutional changes and average years in power


```{r}
violence <- read_csv("data(final project gov 50)/Violence/violence.csv")

dpi <- read_csv("data(final project gov 50)/DPI2020/DPI2020.csv")

violence <- 
  violence |>
  mutate(constch_overall = constchg70 + constchg80) 

dpi <- 
  dpi |>
  filter(year >= 1970 & year <= 1989) 
  
  dpi <- 
   dpi |>
  group_by(country) |>
  mutate(avg_yrsoffc = mean(yrsoffc, na.rm = TRUE)) |>
  filter(avg_yrsoffc >= 0)
  
  colnames(dpi) [1] <- "country"
  
dpi <- 
  dpi|>
  mutate(country = toupper(country))

 data <- 
   merge(violence, dpi, by = "country") 
 
 data <- data |>
   select(country,year, constchg70, constchg80, constch_overall, corrupti, yrsoffc, avg_yrsoffc)
 


```


                                                    
                                                                                            
## Visualisation 1 - Corruption vs. Number of Constitutional Changes

```{r}
data |>
ggplot(mapping = aes(x = corrupti, y = constch_overall)) + geom_point() + labs (title = "Number of Constitutional Changes by Corruption Level", y = "Number of Constitutional Changes", x = "Corruption Level") 

```






## Visualisation 2 - Avg Number of Constitutional Changes vs. AVGYRSOFFC

```{r}
data |>
  group_by(country) |>
  filter(row_number() == 1) |>
  ggplot(mapping = aes(y = avg_yrsoffc, x = constch_overall)) + geom_col()


```

```{r}
summary(data$avg_yrsoffc)
```




## Results From First Analysis

By conducting this analysis, my aim was to further investigate the relationship between corruption levels and frequencies of constitutional change globally. Through the linear regression model, we can observe that each unit increase in corruption is associated with a decrease of 0.1214 in the number of major constitutional changes. Additionally, the intercept relays that for a country with a corruption level of 0, the expected number of major constitutional changes would be 0.8062.
 Thus, we can conclude that the correlation between corruption levels and frequencies of constitutional change is negative, which is shown by the estimated line of best fit on the scatterplot below.
 

```{r}
fit <- lm(constch_overall ~ corrupti, data = data)

fit

fit_visual <- data |> ggplot(mapping = aes(x = corrupti, y = constch_overall)) + geom_point() + geom_smooth(method = lm, colour = "brown") + labs(title = "Linear Regression on Corruption and Constitutional Changes", y = "Number of Constitutional Changes", x = "Corruption Level")

fit_visual
```




























