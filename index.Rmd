---
title: "Gov 50 Final Project"
author: "Ayla Aliyeva"
description: "Corruption, Constitutional Changes, Leadership: An Analysis"
output:
  distill::distill_article:
    self_contained: false
---

## Set up chunk
```{r}
library(tidyverse)
library(ggthemes)
library(wesanderson)
library(jtools)
library(modelsummary)
```


## Introduction

Do higher levels of corruption lead to more frequent constitutional changes? If so, is there a direct correlation between this trend and the average number of years the Chief Executive of a country stays in power? In this study, I examine data from a variety of countries in order to explore the relationship between these variables throughout the two decades of the 1970s and 1980s. I hypothesise that higher levels of corruption are positively correlated with more frequent constitutional changes and a higher average period within which a Chief Executive remains in office. This hypothesis is grounded in the theory that governments with higher corruption levels are more likely to revise legislation in order to hold on to power.

 I find the study exciting in that it attempts to explore the implications of corruption in the misuse of power to influence constitutional frameworks and governance. In the case that the data supports the hypothesis, this would point to a countryâ€™s level of corruption as a determinant of both the nature of its legal system, as well as the course of its executive leadership.





## Preparing the data

```{r}

## Reading data files

violence <- read_csv("data(final project gov 50)/Violence/violence.csv")

dpi <- read_csv("data(final project gov 50)/DPI2020/DPI2020.csv")


## Calculating overall number of constitutional changes for each country over a given period

violence <- 
  violence |>
  group_by(country) |>
  mutate(constch_overall = constchg70 + constchg80) 


## Calculating the average number of years Chief Executive has been in office for each country

colnames(dpi) [1] <- "country"

dpi <- 
   dpi |>
  group_by(country) |>
  mutate(avg_yrsoffc = mean(yrsoffc, na.rm = TRUE)) |>
  filter(yrsoffc >= 0)


## Filtering one of the data sources to only include needed decades

dpi <- 
  dpi |>
  filter(year >= 1970 & year <= 1989) 
  
  
## Merging data sources by country

dpi <- 
  dpi|>
  mutate(country = toupper(country))

 data <- 
   merge(violence, dpi, by = "country")
 
 
 ## Tidying up the data: selecting needed variables
 
 data <- data |>
   select(country,year, constchg70, constchg80, constch_overall, corrupti, yrsoffc, avg_yrsoffc)
 


```




## Visualisation 1 - Summary of constch_overall


```{r}

## Creating an object that extracts first observation for each country
countryonce_data <-
  data |>
  group_by(country) |>
  slice(1)


## Bar plot summarizing key dependent variable
countryonce_data |>
  ggplot(mapping = aes(x = constch_overall)) + 
  geom_density(fill = "lightsteelblue") + 
  labs(title = "Frequency of Constitutional Change Across Countries", y = "Number of Countries", x = "Number of Major Constitutional Changes (1970s-1980s)") + 
  theme_calc() +
  theme(text = element_text("Georgia"))


```






## Visualisation 2 - Results, Regression, Combining everything 
 

```{r}

## Creating a variable with categories describing average years of countries' Chief Executive in office

data <- 
  data |>
  mutate(avgyrs_range = case_when(
    avg_yrsoffc <= 5 ~ "5 Years and Under",
    avg_yrsoffc > 5 & avg_yrsoffc <= 15 ~ "Between 5 and 15 Years",
    avg_yrsoffc > 15 & avg_yrsoffc <= 25 ~ "Between 15 and 25 Years",
    avg_yrsoffc >= 25 ~ "Over 25 Years"
  )) 


## Plot of main analysis 

fit_visual <- 
  data |>
  ggplot(mapping = aes(x = corrupti, y = constch_overall, colour = avgyrs_range)) + 
  geom_point() + 
  geom_smooth(method = lm, colour = "salmon") + 
  labs(title = "Linear Regression on Corruption and Constitutional Changes", y = "Number of Constitutional Changes", x = "Corruption Level", colour = "Mean Chief Executive Term") + 
  scale_x_reverse() +
  scale_x_continuous(breaks = c(0,1,2,3,4,5,6), labels = c("6 (Least Corrupt)", "5","4","3","2","1","0 (Most Corrupt)")) + 
  theme_calc() +
  scale_color_manual(values = wes_palette("FantasticFox1")) +
 theme(text = element_text("Georgia"))

fit_visual


## Regression Output

fit <- lm(constch_overall ~ corrupti + avg_yrsoffc, data = data)

modelsummary::modelsummary(fit,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("")) 








```